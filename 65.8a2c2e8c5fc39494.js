"use strict";(self.webpackChunkFarmatodoEtiquetado=self.webpackChunkFarmatodoEtiquetado||[]).push([[65],{2065:(O,d,o)=>{o.r(d),o.d(d,{PromotionComponentRoutingModule:()=>y});var c=o(8555),u=o(3457);class P extends u.bY{}var m=o(9223),t=o(5e3),g=o(520),T=o(4850),v=o(9605);let b=(()=>{class e{constructor(n){this.http=n}processLabel(n){const i=(new g.LE).append(m.g.REQUEST_JSON,JSON.stringify(n));return this.http.post(v.X.settings.urlAPI.labelingWscUrl.toString()+"/rest/get/promo/price/label",i,{headers:m.g.HTTP_HEADERS}).pipe((0,T.U)(s=>s))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(g.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=o(768),f=o(1496),a=o(3075),h=o(7322),C=o(7531),q=o(7110),R=o(7423);const L=function(){return{standalone:!0}},M=[{path:"promotion",component:(()=>{class e{constructor(n,i,s){this.promotionService=n,this.token=i,this.translate=s,this.form={},this.application={},this.security={},this.sku="",this.errorMessage="",this.quantity=1,this.labelPrint="",this.loadingPanelVisible=!1,this.showPromotionModule=!1,this.requestTo=new u.bY,this.requestToInit=new u.hm,this.promotionLabelRequest=new P,this.sendPrintItem=()=>{this.promotionLabelRequest.item=this.form.item,this.promotionLabelRequest.storeId=this.currentUser.defaultShop.ussh_shops_id,this.setAttributesGenericRequest("promotionLabelRequest"),void 0!==this.promotionLabelRequest.item&&(this.loadingPanelVisible=!this.loadingPanelVisible,this.errorMessage="",this.promotionService.processLabel(this.promotionLabelRequest).subscribe(r=>{if("FTD-200"===r.cod){let p;this.labelPrint=r.stringLabelingChaing,p=this.labelPrint.replace("P1","P"+this.quantity),""!==p?(writeToSelectedPrinter(p),this.promotionLabelRequest.item="",this.form.item=""):(this.sku="0",this.translate.instant("TAG_PROMOTION_NO_VALID"))}else this.form.item="",this.errorMessage=r.message},r=>{this.errorMessage=r.statusText}))},this.setAttributesGenericRequest=r=>{this[r].setAttributesGenericRequest(this.requestTo)},s.setDefaultLang("es"),s.use("es")}validateQty(){this.quantity=this.quantity>10?10:this.quantity}ngOnInit(){this.loadingPanelVisible=!this.loadingPanelVisible,setup();const n=this.translate.instant("TAG_PROFILE_TITLE");this.requestTo.setRequestTo(this.requestToInit,n,m.g.TRANSACTION_TYPE.get),this.currentUser=this.token.getUser(),this.showPromotionModule=this.currentUser.funcionalities.functionalities.filter(i=>"Promo"===i.name).length,this.loadingPanelVisible=!this.loadingPanelVisible,this.promotionLabelRequest.item=""}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(b),t.Y36(A.i),t.Y36(f.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-promotion"]],decls:28,vars:26,consts:[[1,"simple-container"],[1,"jumbotron"],["promoForm","ngForm"],["appearance","outline"],["matInput","","placeholder","","id","item","name","item","required","","autofocus","",3,"appFtdDirectives","ngModel","ngModelChange"],["id","quantityPromotion","min","1","max","10","required","","type","number","matInput","",1,"input-text-center",3,"value","ngModel","ngModelOptions","valueChange","ngModelChange","change"],["mat-raised-button","","color","primary",3,"disabled","id","keyup.enter","click"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"header",1)(2,"h3"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"form",null,2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"input",4),t.NdJ("ngModelChange",function(r){return i.form.item=r}),t.qZA(),t.TgZ(12,"mat-error"),t._uU(13),t.ALo(14,"translate"),t.qZA()(),t._UZ(15,"br"),t.TgZ(16,"mat-form-field",3)(17,"mat-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"input",5),t.NdJ("valueChange",function(r){return i.quantity=r})("ngModelChange",function(r){return i.quantity=r})("change",function(){return i.validateQty()}),t.qZA(),t.TgZ(21,"mat-error"),t._uU(22),t.ALo(23,"translate"),t.qZA()(),t._UZ(24,"br"),t.TgZ(25,"button",6),t.NdJ("keyup.enter",function(){return i.sendPrintItem()})("click",function(){return i.sendPrintItem()}),t._uU(26),t.ALo(27,"translate"),t.qZA()()()),2&n){const s=t.MAs(6);t.xp6(3),t.hij(" ",t.lcZ(4,13,"TAG_PROMOTION_TITLE")," "),t.xp6(6),t.Oqu(t.lcZ(10,15,"TAG_PROMOTION_CODE")),t.xp6(2),t.Q6J("appFtdDirectives",!0)("ngModel",i.form.item),t.xp6(2),t.Oqu(t.lcZ(14,17,"TAG_FIELD_REQUIRED")),t.xp6(5),t.hij(" ",t.lcZ(19,19,"TAG_EXPRESS_QTY")," "),t.xp6(2),t.Q6J("value",i.quantity)("ngModel",i.quantity)("ngModelOptions",t.DdM(25,L)),t.xp6(2),t.Oqu(t.lcZ(23,21,"TAG_FIELD_REQUIRED")),t.xp6(3),t.s9C("id",i.labelPrint),t.Q6J("disabled",!s.form.valid),t.xp6(1),t.hij(" ",t.lcZ(27,23,"TAG_EXPRESS_BUTTON")," ")}},directives:[a._Y,a.JL,a.F,h.KE,h.hX,C.Nt,a.Fj,a.Q7,q.m,a.JJ,a.On,h.TO,a.qQ,a.Fd,a.wV,R.lW],pipes:[f.X$],styles:[""]}),e})()}];let y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.Bz.forChild(M)],c.Bz]}),e})()}}]);