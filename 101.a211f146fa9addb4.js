"use strict";(self.webpackChunkFarmatodoEtiquetado=self.webpackChunkFarmatodoEtiquetado||[]).push([[101],{1101:(D,p,o)=>{o.r(p),o.d(p,{ShelveComponentRoutingModule:()=>y});var _=o(8555),m=o(3457);class E extends m.bY{constructor(){super(...arguments),this.shelfItemTo={item:""}}}class v extends m.bY{constructor(){super(...arguments),this.labelingPendingTo={item:"",assortmentId:""}}}class A extends m.bY{constructor(){super(...arguments),this.assortmentItems=[]}}var h=o(9223),C=o(2654),e=o(5e3),u=o(520),g=o(9605);let L=(()=>{class s{constructor(t){this.http=t}searchAll(t){const n=h.g.HTTP_HEADERS_IN,i=(new u.LE).append(h.g.REQUEST_JSON,JSON.stringify(t));return this.http.post(g.X.settings.urlAPI.assormentUrl.toString()+"/rest/shelf/searchAll",i,{headers:n})}buildLabel(t){const n=h.g.HTTP_HEADERS_IN,i=(new u.LE).append(h.g.REQUEST_JSON,JSON.stringify(t));return this.http.options(g.X.settings.urlAPI.labelingUrl.toString()+"/rest/labeling/assortment/get/data/and/build/labels",{params:i,headers:n})}getPending(t){const n=h.g.HTTP_HEADERS_IN,i=(new u.LE).append(h.g.REQUEST_JSON,JSON.stringify(t));return this.http.options(g.X.settings.urlAPI.labelingUrl.toString()+"/rest/assortment/get/pending",{params:i,headers:n})}setPending(t){const n=h.g.HTTP_HEADERS_IN,i=(new u.LE).append(h.g.REQUEST_JSON,JSON.stringify(t));return this.http.options(g.X.settings.urlAPI.labelingUrl.toString()+"/rest/assortment/set/pending",{params:i,headers:n})}searchItemShelf(t){const n=h.g.HTTP_HEADERS_IN,i=(new u.LE).append(h.g.REQUEST_JSON,JSON.stringify(t));return this.http.post(g.X.settings.urlAPI.assormentUrl.toString()+"/rest/shelfitem/searchitemshelf",i,{headers:n})}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(u.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var q=o(768),T=o(1496),R=o(8182),I=o(8978),c=o(3075),S=o(7322),Z=o(4107),x=o(508),b=o(9808),N=o(7531),P=o(7423);function O(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"mat-form-field",11)(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"input",12),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().item=i}),e.qZA(),e.TgZ(5,"mat-error"),e._uU(6," El item es "),e.TgZ(7,"b"),e._uU(8,"requerido"),e.qZA(),e._uU(9,". "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"TAG_SHELVES_CODE")),e.xp6(2),e.Q6J("ngModel",t.item)}}function M(s,a){if(1&s&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&s){const t=a.$implicit;e.s9C("title",t.assortmentName),e.Q6J("value",t.assortmentId),e.xp6(1),e.hij(" ",t.assortmentName," ")}}function U(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"mat-form-field",13)(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-select",14),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().selectedShelf=i}),e.YNc(5,M,2,3,"mat-option",15),e.qZA(),e.TgZ(6,"mat-error"),e._uU(7," El anaquel es "),e.TgZ(8,"b"),e._uU(9,"requerido"),e.qZA(),e._uU(10,". "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,3,"TAG_SHELVES_SELECT_2_LABEL")),e.xp6(2),e.Q6J("ngModel",t.selectedShelf),e.xp6(1),e.Q6J("ngForOf",t.shelvesList)}}function H(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"mat-form-field",13)(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-select",17),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().selectedScope=i}),e.TgZ(5,"mat-option",18),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"mat-option",19),e._uU(9),e.ALo(10,"translate"),e.qZA()(),e.TgZ(11,"mat-error"),e._uU(12," El alcance es "),e.TgZ(13,"b"),e._uU(14,"requerido"),e.qZA(),e._uU(15,". "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,4,"TAG_SHELVES_SELECT_3_LABEL")," "),e.xp6(2),e.Q6J("ngModel",t.selectedScope),e.xp6(2),e.Oqu(e.lcZ(7,6,"TAG_SHELVES_SELECT_3_OPTION_1")),e.xp6(3),e.Oqu(e.lcZ(10,8,"TAG_SHELVES_SELECT_3_OPTION_2"))}}function J(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().searchByItem()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&s){e.oxw();const t=e.MAs(6);e.Q6J("disabled",!t.form.valid),e.xp6(1),e.hij(" ",e.lcZ(2,2,"TAG_SHELVES_SEARCH")," ")}}function w(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().buildLabel()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&s){e.oxw();const t=e.MAs(6);e.Q6J("disabled",!t.form.valid),e.xp6(1),e.hij(" ",e.lcZ(2,2,"TAG_SHELVES_BUTTON")," ")}}const F=function(){return{standalone:!0}},G=[{path:"search",component:(()=>{class s{constructor(t,n,i,r,f){this.shelvesService=t,this.token=n,this.translate=i,this.snackbarBaseComponent=r,this.dialogConfirm=f,this.form={},this.showInputItem=!1,this.showSelectAllShelves=!1,this.showSelectScope=!1,this.buttonSearch=!1,this.labelCount=0,this.count=0,this.buttonPrint=!1,this.labelingToPrint=[],this.requestTo=new m.bY,this.requestToInit=new m.hm,this.shelfRequest=new E,this.assormentRequest=new v,this.labelRequest=new A,this.subscriptions=new C.w,this.searchByShelf=()=>{this.cleanData(),"SHELF"===this.selectedTypeSearch?(this.showInputItem=!1,this.setAttributesGenericRequest("shelfRequest"),this.shelvesService.searchAll(this.shelfRequest).subscribe(l=>{"FTD-200"===l.cod&&(this.shelvesList=l.shelfToList,this.showSelectAllShelves=!0,this.showSelectScope=!0,this.buttonSearch=!1,this.buttonPrint=!0)})):(this.buttonSearch=!0,this.buttonPrint=!1,this.showSelectAllShelves=!1,this.showSelectScope=!1,this.showInputItem=!0)},this.searchByItem=()=>{""!==this.item&&(this.shelfRequest.shelfItemTo.item=this.item,this.setAttributesGenericRequest("shelfRequest"),this.shelvesService.searchItemShelf(this.shelfRequest).subscribe(l=>{"FTD-200"===l.cod&&(this.shelvesList=l.shelfItemToList,this.showSelectAllShelves=!0,this.showSelectScope=!0,this.buttonSearch=!1,this.buttonPrint=!0)}))},this.setPending=l=>{this.assormentRequest.storeId=this.currentUser.defaultShop.ussh_shops_id,this.assormentRequest.labelingPendingTo.assortmentId=this.selectedShelf,this.assormentRequest.labelingPendingTo.item=l,this.setAttributesGenericRequest("assormentRequest"),this.shelvesService.setPending(this.assormentRequest).subscribe(d=>{if("FTD-200"!==d.cod)return!1})},this.getPending=()=>{this.assormentRequest.storeId=this.currentUser.defaultShop.ussh_shops_id,this.assormentRequest.labelingPendingTo.assortmentId=this.selectedShelf,this.setAttributesGenericRequest("assormentRequest"),this.shelvesService.getPending(this.assormentRequest).subscribe(l=>{"FTD-200"===l.cod&&(this.labelRequest.storeId=this.currentUser.defaultShop.ussh_shops_id,this.labelRequest.assortmentId=this.selectedShelf,this.labelRequest.isWholeAssortment=1===Number(this.selectedScope),this.labelRequest.assortmentItems=l.labelingPendingToList,this.setAttributesGenericRequest("labelRequest"),this.shelvesService.buildLabel(this.labelRequest).subscribe(d=>{"FTD-200"===d.cod&&(this.stringLabelingChaing=d.stringLabelingChaing,this.labelCount=d.labelCount,this.count=0,this.labelingToPrint=this.stringLabelingChaing.split("P1\r\n,"),this.showConfirm())}))})},this.buildLabel=()=>{2===Number(this.selectedScope)?this.getPending():(this.labelRequest.storeId=this.currentUser.defaultShop.ussh_shops_id,this.labelRequest.assortmentId=this.selectedShelf,this.labelRequest.isWholeAssortment=1===Number(this.selectedScope),this.setAttributesGenericRequest("labelRequest"),this.shelvesService.buildLabel(this.labelRequest).subscribe(l=>{"FTD-200"===l.cod&&(this.stringLabelingChaing=l.stringLabelingChaing,this.labelCount=l.labelCount,this.count=0,this.labelingToPrint=this.stringLabelingChaing.split("P1\r\n,"),this.showConfirm())}))},this.setAttributesGenericRequest=l=>{this[l].setAttributesGenericRequest(this.requestTo)},i.setDefaultLang("es"),i.use("es")}ngOnInit(){setup();const t=this.translate.instant("TAG_SHELVES");this.requestTo.setRequestTo(this.requestToInit,t,h.g.TRANSACTION_TYPE.get),this.currentUser=this.token.getUser()}cleanData(){this.shelvesList=[],this.item="",this.selectedShelf=""}printLabel(){let t;this.count!==Number(this.labelCount)&&readFromSelectedPrinter2().then(()=>{t=this.labelingToPrint[this.count]+"P1\r\n",writeToSelectedPrinter(t),this.count++,this.printLabel()}).catch(n=>{this.confirmPrintError(n)})}confirmPrintError(t){let n=this.translate.instant("TAG_SHELVES_ERROR_CONFIRM"),r=this.labelingToPrint[this.count].match(/\d{9}/gim);n=n.replace(/ITEM/gi,String(r[0])),this.subscriptions.add(this.dialogConfirm.openDialogConfirm("TAG_SHELVES_TITLE_ERROR",n+" "+t).subscribe(f=>{f&&(this.count++,(void 0!==r[0]||null!==r[0]||""!==r[0])&&this.setPending(r[0]),this.printLabel())}))}showConfirm(){let t=this.translate.instant("TAG_SHELVES_MSG_CONFIRM");t=t.replace(/LABELCOUNT/gi,String(this.labelCount)),this.subscriptions.add(this.dialogConfirm.openDialogConfirm("TAG_SHELVES_TITLE_WINDOW",t).subscribe(i=>{i&&this.printLabel()}))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(L),e.Y36(q.i),e.Y36(T.sK),e.Y36(R.p),e.Y36(I.a))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-search-shelve"]],decls:23,vars:20,consts:[[1,"simple-container"],[1,"jumbotron"],[1,"container"],["shelfForm","ngForm"],["appearance","outline"],["required","",3,"ngModelOptions","ngModel","ngModelChange","selectionChange"],["value","SHELF"],["value","ITEM"],["class","example-full-width","appearance","outline",4,"ngIf"],["appearance","fill",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["appearance","outline",1,"example-full-width"],["matInput","","required","","name","item",3,"ngModel","ngModelChange"],["appearance","fill"],["name","selectedShelf","required","",3,"ngModel","ngModelChange"],[3,"value","title",4,"ngFor","ngForOf"],[3,"value","title"],["name","selectedScope","required","",3,"ngModel","ngModelChange"],["value","1"],["value","2"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"header",1)(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"form",2,3)(7,"mat-form-field",4)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"mat-select",5),e.NdJ("ngModelChange",function(r){return n.selectedTypeSearch=r})("selectionChange",function(){return n.searchByShelf()}),e.TgZ(12,"mat-option",6),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"mat-option",7),e._uU(16),e.ALo(17,"translate"),e.qZA()()(),e.YNc(18,O,10,4,"mat-form-field",8),e.YNc(19,U,11,5,"mat-form-field",9),e.YNc(20,H,16,10,"mat-form-field",9),e.YNc(21,J,3,4,"button",10),e.YNc(22,w,3,4,"button",10),e.qZA()()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,11,"TAG_SHELVES")," "),e.xp6(6),e.Oqu(e.lcZ(10,13,"TAG_SHELVES_LABEL")),e.xp6(2),e.Q6J("ngModelOptions",e.DdM(19,F))("ngModel",n.selectedTypeSearch),e.xp6(2),e.Oqu(e.lcZ(14,15,"TAG_SHELVES_SELECT_OPTION_1")),e.xp6(3),e.Oqu(e.lcZ(17,17,"TAG_SHELVES_SELECT_OPTION_2")),e.xp6(2),e.Q6J("ngIf",n.showInputItem),e.xp6(1),e.Q6J("ngIf",n.showSelectAllShelves),e.xp6(1),e.Q6J("ngIf",n.showSelectScope),e.xp6(1),e.Q6J("ngIf",n.buttonSearch),e.xp6(1),e.Q6J("ngIf",n.buttonPrint))},directives:[c._Y,c.JL,c.F,S.KE,S.hX,Z.gD,c.Q7,c.JJ,c.On,x.ey,b.O5,N.Nt,c.Fj,S.TO,b.sg,P.lW],pipes:[T.X$],styles:[".mat-option[_ngcontent-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif;font-size:12px}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:1rem auto;max-width:600px}.mat-select-value[_ngcontent-%COMP%]{color:#000}"]}),s})()}];let y=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[_.Bz.forChild(G)],_.Bz]}),s})()}}]);