var S=(i,f,a)=>new Promise((l,c)=>{var s=n=>{try{e(a.next(n))}catch(t){c(t)}},o=n=>{try{e(a.throw(n))}catch(t){c(t)}},e=n=>n.done?l(n.value):Promise.resolve(n.value).then(s,o);e((a=a.apply(i,f)).next())});($jscomp=$jscomp||{}).scope={},$jscomp.checkStringArgs=function(i,f,a){if(null==i)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return i+""},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(i,f,a){i!=Array.prototype&&i!=Object.prototype&&(i[f]=a.value)},$jscomp.getGlobal=function(i){return"undefined"!=typeof window&&window===i?i:"undefined"!=typeof global&&null!=global?global:i},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(i,f,a,l){if(f){for(a=$jscomp.global,i=i.split("."),l=0;l<i.length-1;l++){var c=i[l];c in a||(a[c]={}),a=a[c]}(f=f(l=a[i=i[i.length-1]]))!=l&&null!=f&&$jscomp.defineProperty(a,i,{configurable:!0,writable:!0,value:f})}},$jscomp.polyfill("String.prototype.startsWith",function(i){return i||function(f,a){var l=$jscomp.checkStringArgs(this,f,"startsWith"),c=l.length,s=(f+="").length;a=Math.max(0,Math.min(0|a,l.length));for(var o=0;o<s&&a<c;)if(l[a++]!=f[o++])return!1;return o>=s}},"es6","es3");var selected_device,BrowserPrint=function(){function i(e,n){var t=new XMLHttpRequest;return"withCredentials"in t?t.open(e,n,!0):"undefined"!=typeof XDomainRequest?(t=new XDomainRequest).open(e,n):t=null,t}function f(e,n,t){return void 0===n&&(n=l.defaultSuccessCallback),void 0===t&&(t=l.defaultErrorCallback),a(e,n,t)}function a(e,n,t){return e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status?n(""===e.responseType?e.responseText:e.response):e.readyState===XMLHttpRequest.DONE&&(t?t(e.response):console.log("error occurred with no errorCallback set."))},e}var l={},c={},s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);navigator.userAgent.indexOf("Trident/7.0");var o="http://127.0.0.1:9100/";return s&&"https:"===location.protocol&&(o="https://127.0.0.1:9101/"),l.Device=function(e){var n=this;this.name=e.name,this.deviceType=e.deviceType,this.connection=e.connection,this.uid=e.uid,this.version=2,this.provider=e.provider,this.manufacturer=e.manufacturer,this.readRetries="bluetooth"===this.connection?1:0,this.sendErrorCallback=function(t){},this.sendFinishedCallback=function(t){},this.readErrorCallback=function(t){},this.readFinishedCallback=function(t){},this.send=function(t,r,u){var h=i("POST",o+"write");h&&(void 0!==n&&(void 0===r&&(r=n.sendFinishedCallback),void 0===u&&(u=n.sendErrorCallback)),a(h,r,u),h.send(JSON.stringify({device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer},data:t})))},this.sendUrl=function(t,r,u,h){var d=i("POST",o+"write");d&&(a(n,d,r),t={device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer},url:t},null!=h&&null!=h&&(t.options=h),d.send(JSON.stringify(t)))},this.sendFile=function(t,r,u){if("string"==typeof t)l.loadFileFromUrl(t,function(v){n.sendFile(v,r,u)},u);else{var h=i("POST",o+"write");if(h){h.responseType="text",f(h,r,u);var d=new FormData,p={};p.device=n,d.append("json",JSON.stringify(p)),d.append("blob",t),h.send(d)}}},this.convertAndSendFile=function(t,r,u,h){h||(h={}),h.action||(h.action="print"),l.convert(t,this,h,r,u)},this.read=function(t,r){var u=i("POST",o+"read");u&&(void 0!==n&&(void 0===t&&(t=n.readFinishedCallback),void 0===r&&(r=n.readErrorCallback)),a(u,t,r),u.send(JSON.stringify({device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer}})))},this.readUntilStringReceived=function(t,r,u,h,d){var p,v,_,y,m;d||(d=""),void 0===h&&(h=this.readRetries),p=this,v=r,_=u,y=h,m=d,this.read(r=function(g){if(g&&0!==g.length)y=0;else if(0>=y)return void v(m);g=m+g,""!==t&&-1<g.indexOf(t)?v(g):p.readUntilStringReceived(t,v,_,y-1,g)},u)},this.readAllAvailable=function(t,r,u){this.readUntilStringReceived("",t,r,u)},this.sendThenRead=function(t,r,u){var h;this.send(t,(h=this,function(){h.read(r,u)}),u)},this.sendThenReadUntilStringReceived=function(t,r,u,h,d){var p;this.send(t,(p=this,function(){p.readUntilStringReceived(r,u,h,d)}),h)},this.sendThenReadAllAvailable=function(t,r,u,h){var d;this.send(t,(d=this,function(){d.readUntilStringReceived("",r,u,h)}),u)}},l.defaultSuccessCallback=function(){},l.defaultErrorCallback=function(){},l.ApplicationConfiguration=function(){this.application={version:"1.2.0.3",build_number:3,api_level:2,platform:"",supportedConversions:{}}},l.getLocalDevices=function(e,n,t){var r=i("GET",o+"available");r&&(finishedFunction=function(u){for(var h in response=u,response=JSON.parse(response),response)if(response.hasOwnProperty(h)&&response[h].constructor===Array)for(arr=response[h],u=0;u<arr.length;++u)arr[u]=new l.Device(arr[u]);void 0===t?e(response):(response.hasOwnProperty(t)||(response[t]=[]),e(response[t]))},f(r,finishedFunction,n),r.send())},l.getDefaultDevice=function(e,n,t){var r="default";void 0!==e&&null!=e&&(r=r+"?type="+e),(e=i("GET",o+r))&&(finishedFunction=function(u){response=u,""===response?n(null):(response=JSON.parse(response),u=new l.Device(response),n(u))},(e=f(e,finishedFunction,t)).send())},l.getApplicationConfiguration=function(e,n){var t=i("GET",o+"config");t&&(finishedFunction=function(r){response=r,""===response?e(null):(response=JSON.parse(response),e(response))},f(t,finishedFunction,n),t.send())},l.readOnInterval=function(e,n,t){(void 0===t||0===t)&&(t=1),readFunc=function(){e.read(function(r){n(r),c[e]=setTimeout(readFunc,t)},function(r){c[e]=setTimeout(readFunc,t)})},c[e]=setTimeout(readFunc,t)},l.stopReadOnInterval=function(e){c[e]&&clearTimeout(c[e])},l.bindFieldToReadData=function(e,n,t,r){l.readOnInterval(e,function(u){""!==u&&(n.value=u,void 0!==r&&null!=r&&r())},t)},l.loadFileFromUrl=function(e,n,t){request=i("get",e),request.responseType="blob",f(request,n,t),request.send()},l.convert=function(e,n,t,r,u){if(e)if("string"==typeof e)l.loadFileFromUrl(e,function(v){t.fromFormat||(t.fromFormat=e.substring(e.length-3)),l.convert(v,n,t,r,u)},u);else{var h=i("POST",o+"convert");if(e.type&&(e.type.startsWith("image/")||e.type.startsWith("application/"))&&(t.fromFormat=e.type.toLowerCase().replace("image/","").replace("application/","").replace("x-ms-","")),h){h.responseType="text",f(h,function(v){r(JSON.parse(v))},u);var d=new FormData,p={};null!=t&&void 0!==t&&(p.options=t),n&&(p.device=n),d.append("json",JSON.stringify(p)),d.append("blob",e),h.send(d)}}else u?u("Resource not specified"):l.defaultErrorCallback("Resource not specified")},l}(),devices=[];function setup(){BrowserPrint.getDefaultDevice("printer",function(i){selected_device=i,devices.push(i),BrowserPrint.getLocalDevices(function(a){for(var l=0;l<a.length;l++){var c=a[l];(!selected_device||c.uid!=selected_device.uid)&&devices.push(c)}},function(){alert("Error getting local devices")},"printer");var f=document.getElementById("labelPrintName");null!=f&&(f.innerHTML=null==selected_device.name?"<strong>Sin Impresora Asociada</strong>":" Impresora: "+selected_device.name.substring(0,11))},function(i){alert("No se ha detectado ninguna impresora!!\nInicie Browser Print de ZEBRA"),window.location.href="home"})}function getConfig(){BrowserPrint.getApplicationConfiguration(function(i){alert(JSON.stringify(i))},function(i){alert(JSON.stringify(new BrowserPrint.ApplicationConfiguration))})}function writeToSelectedPrinter(i){selected_device.send(i,void 0,errorCallback)}var readCallback=function(i){null==i||""===i?alert("La impresora no esta conectada!"):alert(i)};function readFromSelectedPrinter2(){return S(this,null,function*(){return new Promise(function(i,f){checkPrinterStatus(function(a){"Ready to Print"==a||""==a?i(a):f(a)}).catch(f)})})}function checkPrinterStatus(i){return S(this,null,function*(){return new Promise(function(f,a){selected_device.sendThenRead("~HQES",function(l){var s=new Array,o=!1,e=l.charAt(70),n=l.charAt(88),t=l.charAt(87),r=l.charAt(84);"0"==e&&(o=!0,s.push("Ready to Print")),"1"==n&&s.push("Paper out"),"2"==n&&s.push("Ribbon Out"),"4"==n&&s.push("Media Door Open"),"8"==n&&s.push("Cutter Fault"),"1"==t&&s.push("Printhead Overheating"),"2"==t&&s.push("Motor Overheating"),"4"==t&&s.push("Printhead Fault"),"8"==t&&s.push("Incorrect Printhead"),"1"==r&&s.push("Printer Paused"),!o&&0==s.Count&&s.push("Error: Unknown Error"),i(s.join())},function(l){a(l)})})})}var $jscomp,errorCallback=function(i){alert("Error de impresi\xf3n: "+i)};function readFromSelectedPrinter(){selected_device.read(readCallback,errorCallback)}function getDeviceCallback(i){alert("Devices: \n"+JSON.stringify(i,null,4))}function sendImage(i){url=window.location.href.substring(0,window.location.href.lastIndexOf("/")),url=url+"/"+i,selected_device.convertAndSendFile(url,void 0,errorCallback)}function sendFile(i){url=window.location.href.substring(0,window.location.href.lastIndexOf("/")),url=url+"/"+i,selected_device.sendFile(url,void 0,errorCallback)}function onDeviceSelected(i){for(var f=0;f<devices.length;++f)if(i.value==devices[f].uid)return void(selected_device=devices[f])}function dbg(i){}($jscomp=$jscomp||{}).scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(i,f,a){i!=Array.prototype&&i!=Object.prototype&&(i[f]=a.value)},$jscomp.getGlobal=function(i){return"undefined"!=typeof window&&window===i?i:"undefined"!=typeof global&&null!=global?global:i},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var i=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+i++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var i=$jscomp.global.Symbol.iterator;i||(i=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[i]&&$jscomp.defineProperty(Array.prototype,i,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(i){var f=0;return $jscomp.iteratorPrototype(function(){return f<i.length?{done:!1,value:i[f++]}:{done:!0}})},$jscomp.iteratorPrototype=function(i){return $jscomp.initSymbolIterator(),(i={next:i})[$jscomp.global.Symbol.iterator]=function(){return this},i},$jscomp.makeIterator=function(i){$jscomp.initSymbolIterator();var f=i[Symbol.iterator];return f?f.call(i):$jscomp.arrayIterator(i)},$jscomp.polyfill=function(i,f,a,l){if(f){for(a=$jscomp.global,i=i.split("."),l=0;l<i.length-1;l++){var c=i[l];c in a||(a[c]={}),a=a[c]}(f=f(l=a[i=i[i.length-1]]))!=l&&null!=f&&$jscomp.defineProperty(a,i,{configurable:!0,writable:!0,value:f})}},$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.polyfill("Promise",function(i){function f(){this.batch_=null}function a(o){return o instanceof c?o:new c(function(e,n){e(o)})}if(i&&!$jscomp.FORCE_POLYFILL_PROMISE)return i;f.prototype.asyncExecute=function(o){return null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_()),this.batch_.push(o),this},f.prototype.asyncExecuteBatch_=function(){var o=this;this.asyncExecuteFunction(function(){o.executeBatch_()})};var l=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(o){l(o,0)},f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var o=this.batch_;this.batch_=[];for(var e=0;e<o.length;++e){var n=o[e];delete o[e];try{n()}catch(t){this.asyncThrow_(t)}}}this.batch_=null},f.prototype.asyncThrow_=function(o){this.asyncExecuteFunction(function(){throw o})};var c=function(o){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[];var e=this.createResolveAndReject_();try{o(e.resolve,e.reject)}catch(n){e.reject(n)}};c.prototype.createResolveAndReject_=function(){function o(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:o(this.resolveTo_),reject:o(this.reject_)}},c.prototype.resolveTo_=function(o){if(o===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(o instanceof c)this.settleSameAsPromise_(o);else{e:switch(typeof o){case"object":var e=null!=o;break e;case"function":e=!0;break e;default:e=!1}e?this.resolveToNonPromiseObj_(o):this.fulfill_(o)}},c.prototype.resolveToNonPromiseObj_=function(o){var e=void 0;try{e=o.then}catch(n){return void this.reject_(n)}"function"==typeof e?this.settleSameAsThenable_(e,o):this.fulfill_(o)},c.prototype.reject_=function(o){this.settle_(2,o)},c.prototype.fulfill_=function(o){this.settle_(1,o)},c.prototype.settle_=function(o,e){if(0!=this.state_)throw Error("Cannot settle("+o+", "+e|"): Promise already settled in state"+this.state_);this.state_=o,this.result_=e,this.executeOnSettledCallbacks_()},c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var o=this.onSettledCallbacks_,e=0;e<o.length;++e)o[e].call(),o[e]=null;this.onSettledCallbacks_=null}};var s=new f;return c.prototype.settleSameAsPromise_=function(o){var e=this.createResolveAndReject_();o.callWhenSettled_(e.resolve,e.reject)},c.prototype.settleSameAsThenable_=function(o,e){var n=this.createResolveAndReject_();try{o.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},c.prototype.then=function(o,e){function n(h,d){return"function"==typeof h?function(p){try{t(h(p))}catch(v){r(v)}}:d}var t,r,u=new c(function(h,d){t=h,r=d});return this.callWhenSettled_(n(o,t),n(e,r)),u},c.prototype.catch=function(o){return this.then(void 0,o)},c.prototype.callWhenSettled_=function(o,e){function n(){switch(t.state_){case 1:o(t.result_);break;case 2:e(t.result_);break;default:throw Error("Unexpected state: "+t.state_)}}var t=this;null==this.onSettledCallbacks_?s.asyncExecute(n):this.onSettledCallbacks_.push(function(){s.asyncExecute(n)})},c.resolve=a,c.reject=function(o){return new c(function(e,n){n(o)})},c.race=function(o){return new c(function(e,n){for(var t=$jscomp.makeIterator(o),r=t.next();!r.done;r=t.next())a(r.value).callWhenSettled_(e,n)})},c.all=function(o){var e=$jscomp.makeIterator(o),n=e.next();return n.done?a([]):new c(function(t,r){function u(p){return function(v){h[p]=v,0==--d&&t(h)}}var h=[],d=0;do{h.push(void 0),d++,a(n.value).callWhenSettled_(u(h.length-1),r),n=e.next()}while(!n.done)})},c},"es6","es3");var Zebra=function(){function i(c,s){if(s instanceof a.Printer.Status&&l[c.device.uid]){if(s.offline){if(c.errors++,c.errors<c.errorsForOffline)return}else c.errors=0;var o=l[c.device.uid].status,e=JSON.stringify(o);c.status=s,statusStr=JSON.stringify(s),statusStr!==e&&c.onchange(o,s)}}function f(c){return 2===c.charCodeAt(0)&&3===c.charCodeAt(c.length-1)}var a={},l={};return setInterval(function(){for(var c in l)l.hasOwnProperty(c)&&function(s){s.device.getStatus(function(o){i(s,o)},function(o){i(s,new a.Printer.Status(""))})}(c=l[c])},2e3),a.Printer=function(c){BrowserPrint.Device.call(this,c),a.Printer.Status=function(e){this.raw=e,this.isFlagSet=function(n){return"1"===this.raw.charAt(n)},this.offline=!1,e||(e=""),f(e=e.trim())?(this.offline=!1,this.paperOut=this.isFlagSet(5),this.paused=this.isFlagSet(7),this.headOpen=this.isFlagSet(43),this.ribbonOut=this.isFlagSet(45)):(this.offline=!0,this.ribbonOut=this.headOpen=this.paused=this.paperOut=!1),this.isPrinterReady=function(){return!(this.paperOut||this.paused||this.headOpen||this.ribbonOut||this.offline)},this.getMessage=function(){return this.isPrinterReady()?"Ready":this.offline?"Offline":this.paperOut?"Paper Out":this.headOpen?"Head Open":this.ribbonOut?"Ribbon Out":this.paused?"Paused":"Ready"}},a.Printer.Info=function(e){if(!e||(this.raw=e,!f(e=e.trim())))throw"Invalid Response";e=e.split(","),this.model=e[0].substring(1),this.firmware=e[1]},a.Printer.Configuration=function(e){if(!e||(this.raw=e=e.trim(),this.settings={},!f(e)))throw"Invalid Response";e=(e=(e=e.replace(String.fromCharCode(2),"")).replace(String.fromCharCode(3),"")).split("\n");for(var n=0;n<e.length;++n){var t=e[n].trim(),r=t.substring(20);t=t.substring(0,20).trim(),this.settings[r]=t}this.darkness=parseFloat(this.settings.DARKNESS),this.printSpeed=parseInt(this.settings["PRINT SPEED"].replace("IPS","").trim()),this.printWidth=parseInt(this.settings["PRINT WIDTH"]),this.labelLength=parseInt(this.settings["LABEL LENGTH"]),this.firmwareVersion=this.settings.FIRMWARE.replace("<-","").trim(),this.linkOSVersion=this.settings.hasOwnProperty("LINK-OS VERSION")?this.settings["LINK-OS VERSION"]:"0"};var s=this;this.configuration=void 0,this.device_request_queue=[],this.clearRequestQueue=function(){var e=this.device_request_queue[0];this.device_request_queue=[],e&&e.started&&(this.device_request_queue[0]=e)},this.Request=function(e,n,t,r,u){var h;this.type=e,this.command=n,this.received=t,this.success=r,this.error=(h=u,function(d){h(d),s.executeNextRequest()}),this.execute=function(){this.started=!0,"info"==this.type||"config"==this.type||"status"==this.type?s.sendThenReadUntilStringReceived(this.command,String.fromCharCode(3),this.received,this.error):s.sendThenReadAllAvailable(this.command,this.received,this.error)}},this.executeNextRequest=function(){s.device_request_queue.shift(),s.executeRequest()},this.executeRequest=function(){0<s.device_request_queue.length&&s.device_request_queue[0].execute()},this.queueRequest=function(e){s.device_request_queue.push(e),1===s.device_request_queue.length&&e.execute()},this.onStatusResponse=function(e){var n=void 0;try{n=new a.Printer.Status(e)}catch(t){(e=s.device_request_queue[0]).error(t),s.executeNextRequest()}for(;0<s.device_request_queue.length&&"status"===(e=s.device_request_queue[0]).type;)e.success(n),s.device_request_queue.shift();s.executeRequest()},this.onResponse=function(e,n){var t=s.device_request_queue[0];if(null!=n)try{e=new n(e)}catch(r){return t.error&&t.error(r),void s.executeNextRequest()}t.success&&t.success(e),s.executeNextRequest()},this.onSGDResponse=function(e){s.onResponse(e)},this.onInfoResponse=function(e){s.onResponse(e,a.Printer.Info)},this.onConfigurationResponse=function(e){try{s.configuration=new a.Printer.Configuration(e)}catch(n){}s.onResponse(e,a.Printer.Configuration)},this.setSGD=function(e,n,t,r){if(!t&&!r)return new Promise(function(u,h){s.setSGD(e,n,u,h)});s.send('! U1 setvar "'+e+'" "'+n+'"\r\n',t,r)},this.getSGD=function(e,n,t){if(!n&&!t)return new Promise(function(r,u){s.getSGD(e,r,u)});n=new this.Request("sgd",'! U1 getvar "'+e+'"\r\n',this.onSGDResponse,n,t),this.queueRequest(n)},this.setThenGetSGD=function(e,n,t,r){if(!t&&!r)return new Promise(function(u,h){s.setThenGetSGD(e,n,u,h)});this.setSGD(e,n,function(){s.getSGD(e,t,r)},r)},this.getInfo=function(e,n){if(!e&&!n)return new Promise(function(t,r){s.getInfo(t,r)});e=new this.Request("info","~hi\r\n",this.onInfoResponse,e,n),this.queueRequest(e)},this.getConfiguration=function(e,n){if(!e&&!n)return new Promise(function(t,r){s.getConfiguration(t,r)});e=new this.Request("config","^XA^HH^XZ",this.onConfigurationResponse,e,n),this.queueRequest(e)},this.getStatus=function(e,n){if(!e&&!n)return new Promise(function(t,r){s.getStatus(t,r)});e=new this.Request("status","~hs\r\n",this.onStatusResponse,e,n),s.queueRequest(e)},this.query=function(e,n,t){if(!n&&!t)return new Promise(function(r,u){s.query(e,r,u)});n=new this.Request("",e,this.onResponse,n,t),this.queueRequest(n)},this.isPrinterReady=function(e,n){if(!e&&!n)return new Promise(function(t,r){s.isPrinterReady(t,r)});this.getStatus().then(function(t){t.isPrinterReady()?e(t.getMessage()):n(t.getMessage())})},this.printImageAsLabel=function(e,n,t,r){if(!t&&!r)return new Promise(function(u,h){s.printImageAsLabel(e,n,u,h)});o().then(function(u){n.fitTo={width:u.printWidth,height:u.labelLength},n.action="print",BrowserPrint.convert(e,s,n,t,r)}).catch(r)},this.getConvertedResource=function(e,n,t,r){if(!t&&!r)return new Promise(function(u,h){s.getConvertedResource(e,n,u,h)});o().then(function(u){n.action="return",BrowserPrint.convert(e,s,n,t,r)}).catch(r)},this.storeConvertedResource=function(e,n,t,r){if(!t&&!r)return new Promise(function(u,h){s.storeConvertedResource(e,n,u,h)});o().then(function(u){n.action="store",BrowserPrint.convert(e,s,n,t,r)}).catch(r)};var o=function(){return new Promise(function(e,n){if(!s.configuration)return s.getConfiguration().then(function(t){return s.configuration=t,s.configuration}).catch(function(t){n(t)});e(s.configuration)})};this.configTimeout=function(){s.configuration||s.getConfiguration().then(function(e){return s.configuration=e}).catch(function(){setTimeout(s.configTimeout,1e3)})},this.configTimeout()},a.watch=function(c,s,o){o||(o=2),l[c.uid]={device:c,status:"",onchange:s,errors:0,errorsForOffline:o}},a.stopWatching=function(c){delete l[c.uid]},a}();